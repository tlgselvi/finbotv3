services:
  - type: web
    name: finbot-v3
    runtime: node
    plan: starter
    buildCommand: cd QuickServeAPI && npm install --legacy-peer-deps && npm run build:client
    startCommand: cd QuickServeAPI && npx tsx server/index.ts
    envVars:
      - key: NODE_ENV
        value: production
      - key: NODE_VERSION
        value: 20
      - key: DATABASE_URL
        fromDatabase:
          name: finbot-db
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: CORS_ORIGIN
        value: https://finbot-v3.onrender.com
      - key: API_PORT
        value: "10000"
      - key: LOG_LEVEL
        value: info
      - key: BCRYPT_ROUNDS
        value: "12"
      - key: RATE_LIMIT_WINDOW
        value: "15"
      - key: RATE_LIMIT_MAX
        value: "100"
      - key: DEFAULT_CURRENCY
        value: TRY
      - key: VAT_RATE
        value: "0.20"
      - key: SGK_RATE
        value: "0.15"
      - key: ENABLE_ALERTS
        value: "true"
      - key: ENABLE_NOTIFICATIONS
        value: "true"
      - key: ENABLE_MONTE_CARLO
        value: "true"
      - key: ENABLE_SCENARIOS
        value: "true"
      - key: ENABLE_REPORTS
        value: "true"
      - key: MAX_CONCURRENT_REQUESTS
        value: "100"
      - key: REQUEST_TIMEOUT
        value: "30000"
      - key: CACHE_TTL
        value: "3600"

databases:
  - name: finbot-db
    plan: starter
    databaseName: finbot_production
    user: finbot_user
